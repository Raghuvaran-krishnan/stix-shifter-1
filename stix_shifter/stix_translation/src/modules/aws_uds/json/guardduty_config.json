{
    "master_query_reference": "fields @timestamp, {fields}| {parse_query}| filter ({filter_query})| filter ({exclude_non_match})",
    "field_display": ["@message"],
    "field_mapping": {
      "srcAddr": {
        "ipv4-addr:value": "parse @message /(?:\"publicIp\"\\:\")(?<srcAddr>((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))(?:\"\\}\\])/",
        "network-traffic:src_ref.value": "parse @message /(?:\"publicIp\"\\:\")(?<srcAddr>(((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))))(?:\"\\}\\])/"
      },
      "dstAddr":{
        "ipv4-addr:value": "parse @message /(?:\"ipAddressV4\"\\:\")(?<dstAddr>((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))(?:\"\\,)/",
        "network-traffic:dst_ref.value": "parse @message /(?:\"ipAddressV4\"\\:\")(?<dstAddr>((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))(?:\"\\,)/"
      },
      "dstPort": "parse @message /(?:\"remotePortDetails\"\\:\\{)(?:[\"A-Za-z\\:]+)(?<dstPort>\\d+)/",
      "srcPort": "parse @message /(?:\"localPortDetails\"\\:\\{)(?:[\"A-Za-z\\:]+)(?<localport>\\d+)/",
      "protocol": "parse @message /(:?\"protocol\"\\:\")(?<protocol>[a-zA-Z]+)(:?\")/",
      "domain": "parse @message /(?:\"publicDnsName\"\\:\")(?<domain>([a-z0-9]+(-[a-z0-9]+)*)*[\\.\\-a-z0-9]*)(?:\"\\,)/"
  }
}